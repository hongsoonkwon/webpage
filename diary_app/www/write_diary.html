<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì¼ê¸° ì‘ì„±</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <section class="main-content">
    <footer class="breadcrumb">SK's view &gt; Diary</footer>
    <h2 class="side-bar">ğŸ“ Write Diary ğŸ“</h2>

    <div class="diary-container">
      <input type="text" id="diary-title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" class="diary-search" />
      <textarea id="diary-content" rows="10" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" style="width:100%; padding:12px; font-size:16px; border-radius:8px; border:1px solid #ccc;"></textarea>
      <br><br>
      <button class="add-diary-btn" onclick="saveDiary()">ì €ì¥í•˜ê¸°</button>
    </div>
  </section>
  <script>
    const titleInput = document.getElementById('diary-title');
    const contentInput = document.getElementById('diary-content');
  
    function formatDate(date) {
      const yyyy = date.getFullYear();
      const mm = String(date.getMonth() + 1).padStart(2, '0');
      const dd = String(date.getDate()).padStart(2, '0');
      const hh = String(date.getHours()).padStart(2, '0');
      const min = String(date.getMinutes()).padStart(2, '0');
      const ss = String(date.getSeconds()).padStart(2, '0');
      return `${yyyy}-${mm}-${dd} ${hh}:${min}:${ss}`;
    }
  
    function saveDiary() {
      const title = titleInput.value.trim();
      const content = contentInput.value.trim();
  
      if (!title || !content) {
        alert('ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”');
        return;
      }
  
      const diaryData = {
        title,
        content,
        time: formatDate(new Date()), // âœ… ì—¬ê¸°ì„œ time í•„ë“œë¡œ í¬ë§· ë„£ê¸°!!
      };
  
      fetch('http://localhost:3000/api/diary', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(diaryData),
      })
        .then((res) => res.json())
        .then((data) => {
          alert(data.message || 'ì¼ê¸°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
          window.location.href = 'diary.html';
        })
        .catch((err) => {
          console.error('ì—ëŸ¬ ë°œìƒ:', err);
          alert('ì„œë²„ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        });
    }
  </script>
  
  
</body>
</html>
