<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Diary</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
    <footer class="breadcrumb">SK's view &gt; Diary</footer>
    <h2 class="side-bar">ğŸ“¬ Diary ğŸ“¬</h2>
  <section class="main-content">
    <div class="diary-container">
      <input type="text" placeholder="ì¼ê¸° ì œëª© ê²€ìƒ‰..." class="diary-search" onkeyup="filterDiaries()" />

      <div class="diary-list" id="diary-list">
        <!-- JSë¡œ ì¼ê¸° ëª©ë¡ ë¡œë”©ë¨ -->
      </div>
    </div>
  </section>

  <footer style="text-align:center;">
    <button class="add-diary-btn" onclick="location.href='write_diary.html'">+ ìƒˆ ì¼ê¸° ì“°ê¸°</button>
  </footer>
  <script>
    function filterDiaries() {
      const input = document.querySelector('.diary-search');
      const filter = input.value.toLowerCase();
      const diaryBoxes = document.querySelectorAll('.diary-box');
  
      diaryBoxes.forEach(box => {
        const title = box.querySelector('h3').innerText.toLowerCase();
        box.style.display = title.includes(filter) ? 'block' : 'none';
      });
    }
  
    function loadDiaries() {
      const diaryList = document.getElementById('diary-list');
      diaryList.innerHTML = '';
  
      fetch('https://script.google.com/macros/s/AKfycbwZi35S9TfLPdmHIg8bPjW6RS-QJdoYB3fxU947bR0VYYlh4701kUJaOj86E1grIQMVzg/exec')
        .then(res => res.json())
        .then(diaries => {
          
    console.log('ì„œë²„ì—ì„œ ë°›ì€ ì¼ê¸° ëª©ë¡:', diaries); // í™•ì¸!!
          if (diaries.length === 0) {
            diaryList.innerHTML = '<p style="text-align:center; color:gray;">ë“±ë¡ëœ ì¼ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            return;
          }
  
          diaries.forEach(d => {
            const box = document.createElement('div');
            box.className = 'diary-box';
            box.innerHTML = `
              <h3>${d.title}</h3>
              <p>${d.content.slice(0, 50)}...</p>
            `;
            box.onclick = () => location.href = `diary_entry.html?id=${d.index}`; // âœ… ì„œë²„ index ì‚¬ìš©
            diaryList.appendChild(box);
          });
        })
        .catch(err => {
          console.error('ì„œë²„ì—ì„œ ì¼ê¸° ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', err);
          diaryList.innerHTML = '<p style="text-align:center; color:red;">ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</p>';
        });
    }
  
    window.onload = loadDiaries;
  </script>
  
</body>
</html>
